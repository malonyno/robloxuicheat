-- SERVICES
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer

-- VARIABLES
local fly = false
local noclip = false
local speedOn = false
local espOn = false
local infJump = false

local flySpeed = 60
local walkSpeed = 16

local char
local humanoid
local hrp
local cam = workspace.CurrentCamera

-- Fonction pour initialiser les rÃ©fÃ©rences du personnage
local function setupCharacter(newChar)
	char = newChar
	humanoid = char:WaitForChild("Humanoid")
	hrp = char:WaitForChild("HumanoidRootPart")
end

-- Initial setup
setupCharacter(player.Character or player.CharacterAdded:Wait())

-- RÃ©initialisation aprÃ¨s respawn
player.CharacterAdded:Connect(function(newChar)
	setupCharacter(newChar)
end)

-- ================= UI =================
local playerGui = player:WaitForChild("PlayerGui")
local gui = Instance.new("ScreenGui")
gui.Parent = playerGui
gui.ResetOnSpawn = false

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 320, 0, 360)
main.Position = UDim2.new(0.5, -160, 0.5, -180)
main.BackgroundColor3 = Color3.fromRGB(25,25,25)
main.Active = true
main.Draggable = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0,12)

local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1,0,0,40)
title.Text = "âš™ï¸ Roblox Cheat UI"
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 16

local function button(txt, y)
	local b = Instance.new("TextButton", main)
	b.Size = UDim2.new(1,-20,0,32)
	b.Position = UDim2.new(0,10,0,y)
	b.Text = txt
	b.BackgroundColor3 = Color3.fromRGB(45,45,45)
	b.TextColor3 = Color3.new(1,1,1)
	b.Font = Enum.Font.Gotham
	b.TextSize = 14
	Instance.new("UICorner", b)
	return b
end

local flyBtn    = button("âœˆï¸ Fly : OFF",        50)
local speedBtn  = button("âš¡ Speed : OFF",      90)
local espBtn    = button("ğŸ‘ï¸ ESP : OFF",       130)
local noclipBtn = button("ğŸšª Noclip : OFF",     170)
local jumpBtn   = button("ğŸ¦˜ Infinite Jump : OFF", 210)

local speedBox = Instance.new("TextBox", main)
speedBox.Size = UDim2.new(1,-20,0,32)
speedBox.Position = UDim2.new(0,10,0,250)
speedBox.Text = "Vitesse (ex: 60)"
speedBox.TextColor3 = Color3.new(1,1,1)
speedBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
speedBox.Font = Enum.Font.Gotham
speedBox.TextSize = 14
Instance.new("UICorner", speedBox)

-- ================= FLY =================
local bv
local move = {f=0,b=0,l=0,r=0,u=0,d=0}

UIS.InputBegan:Connect(function(i,gp)
	if gp then return end
	if i.KeyCode == Enum.KeyCode.W then move.f=1 end
	if i.KeyCode == Enum.KeyCode.S then move.b=1 end
	if i.KeyCode == Enum.KeyCode.A then move.l=1 end
	if i.KeyCode == Enum.KeyCode.D then move.r=1 end
	if i.KeyCode == Enum.KeyCode.E then move.u=1 end
	if i.KeyCode == Enum.KeyCode.Q then move.d=1 end
end)

UIS.InputEnded:Connect(function(i)
	if i.KeyCode == Enum.KeyCode.W then move.f=0 end
	if i.KeyCode == Enum.KeyCode.S then move.b=0 end
	if i.KeyCode == Enum.KeyCode.A then move.l=0 end
	if i.KeyCode == Enum.KeyCode.D then move.r=0 end
	if i.KeyCode == Enum.KeyCode.E then move.u=0 end
	if i.KeyCode == Enum.KeyCode.Q then move.d=0 end
end)

RunService.RenderStepped:Connect(function()
	if fly and bv then
		local dir =
			cam.CFrame.LookVector * (move.f - move.b) +
			cam.CFrame.RightVector * (move.r - move.l) +
			Vector3.new(0, move.u - move.d, 0)

		bv.Velocity = dir.Magnitude > 0 and dir.Unit * flySpeed or Vector3.zero
	end
end)

flyBtn.MouseButton1Click:Connect(function()
	fly = not fly
	flyBtn.Text = "âœˆï¸ Fly : " .. (fly and "ON" or "OFF")
