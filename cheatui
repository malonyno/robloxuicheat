-- SERVICES
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")
local cam = workspace.CurrentCamera

-- VARIABLES
local fly = false
local noclip = false
local speedOn = false
local espOn = false
local infJump = false

local flySpeed = 60
local walkSpeed = 16

-- ================= UI =================
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.ResetOnSpawn = false

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 320, 0, 340)
main.Position = UDim2.new(0.5, -160, 0.5, -170)
main.BackgroundColor3 = Color3.fromRGB(25,25,25)
main.Active = true
main.Draggable = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0,12)

local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1,0,0,40)
title.Text = "‚öôÔ∏è Roblox Cheat UI"
title.TextColor3 = Color3.new(1,1,1)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 16

local function button(txt, y)
	local b = Instance.new("TextButton", main)
	b.Size = UDim2.new(1,-20,0,32)
	b.Position = UDim2.new(0,10,0,y)
	b.Text = txt
	b.BackgroundColor3 = Color3.fromRGB(45,45,45)
	b.TextColor3 = Color3.new(1,1,1)
	b.Font = Enum.Font.Gotham
	b.TextSize = 14
	Instance.new("UICorner", b)
	return b
end

local flyBtn    = button("‚úàÔ∏è Fly : OFF",        50)
local speedBtn  = button("‚ö° Speed : OFF",      90)
local espBtn    = button("üëÅÔ∏è ESP : OFF",       130)
local noclipBtn = button("üö™ Noclip : OFF",     170)
local jumpBtn   = button("ü¶ò Infinite Jump : OFF", 210)

local speedBox = Instance.new("TextBox", main)
speedBox.Size = UDim2.new(1,-20,0,32)
speedBox.Position = UDim2.new(0,10,0,250)
speedBox.Text = "Vitesse (ex: 60)"
speedBox.TextColor3 = Color3.new(1,1,1)
speedBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
speedBox.Font = Enum.Font.Gotham
speedBox.TextSize = 14
Instance.new("UICorner", speedBox)

-- ================= FLY =================
local bv
local move = {f=0,b=0,l=0,r=0,u=0,d=0}

UIS.InputBegan:Connect(function(i,gp)
	if gp then return end
	if i.KeyCode == Enum.KeyCode.W then move.f=1 end
	if i.KeyCode == Enum.KeyCode.S then move.b=1
local espBoxes = {}

local function addESP(plr)
	if plr.Character and not espBoxes[plr] then
		local box = Instance.new("SelectionBox")
		box.Adornee = plr.Character:FindFirstChild("HumanoidRootPart") or plr.Character:FindFirstChildWhichIsA("BasePart")
		box.LineThickness = 0.1
		box.Color3 = Color3.new(1,1,1) -- blanc
		box.SurfaceTransparency = 1
		box.Parent = workspace
		espBoxes[plr] = box
	end
end

local function removeESP(plr)
	if espBoxes[plr] then
		espBoxes[plr]:Destroy()
		espBoxes[plr] = nil
	end
end

espBtn.MouseButton1Click:Connect(function()
	espOn = not espOn
	espBtn.Text = "üëÅÔ∏è ESP : " .. (espOn and "ON" or "OFF")

	if espOn then
		for _, p in pairs(Players:GetPlayers()) do
			if p ~= player then addESP(p) end
		end
	else
		for _, p in pairs(Players:GetPlayers()) do
			removeESP(p)
		end
	end
end)

-- Pour g√©rer les nouveaux joueurs qui arrivent
Players.PlayerAdded:Connect(function(plr)
	if espOn then
		addESP(plr)
	end
end)

Players.PlayerRemoving:Connect(function(plr)
	removeESP(plr)
end)
